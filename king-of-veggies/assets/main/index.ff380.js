System.register("chunks:///_virtual/AppConst.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"d11a72YoOJKY44ku5JGBNj/","AppConst",void 0);var a=e("mapItemWidth",96),p=e("mapItemHeight",135),m=e("mapItemSpaceX",6),c=e("mapItemSpaceY",3),o=e("mapItemCol",5),n=e("mapItemRow",5),s=(e("mapTotalCount",o*n),e("mapItemAddSpaceWidth",a+m)),l=e("mapItemAddSpaceHeight",p+c);e("mapMaxWidth",s*o),e("mapMaxHeight",l*n),e("maxNumber",7),e("stepMap",[{step:1,start:1,end:1},{step:5,start:1,end:3},{step:10,start:2,end:4},{step:20,start:3,end:6},{step:30,start:4,end:7}]),e("levelMap",[{level:5,numRate:[10,90],typeRate:[100],score:1200,time:2,collectCount:[10]},{level:10,numRate:[10,45,45],typeRate:[100],score:1300,time:2,collectCount:[20]},{level:20,numRate:[10,25,45,20],typeRate:[50,50],score:1800,time:2,collectCount:[10,10]},{level:30,numRate:[20,30,20,20,10],typeRate:[70,30],score:2e3,time:2,collectCount:[30,10]},{level:40,numRate:[10,20,20,20,20,10],typeRate:[40,30,30],score:3500,time:2,collectCount:[10,5,5]}]),e("typeCount",3),e("typeUniversal",4),e("typeScore",[100,200,500]),e("listCardCount",4);t._RF.pop()}}}));

System.register("chunks:///_virtual/AppEnum.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var c,u;e({EResult:void 0,EventType:void 0}),t._RF.push({},"4e02dJKfctAkpM4DWhRZaZ0","AppEnum",void 0),function(e){e[e.NORMAL=0]="NORMAL",e[e.FAIL=1]="FAIL",e[e.WIN_1=2]="WIN_1",e[e.WIN_2=3]="WIN_2"}(c||(c=e("EResult",{}))),function(e){e.createCard="createCard",e.updateScore="updateScore",e.placeCompleted="placeCompleted"}(u||(u=e("EventType",{}))),t._RF.pop()}}}));

System.register("chunks:///_virtual/AppType.ts",["cc"],(function(){"use strict";var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"668ccmU2jhLn5cCx3Yhdwwl","AppType",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/DataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AppConst.ts","./Utils.ts","./AppEnum.ts"],(function(t){"use strict";var e,r,n,s,i,u,a,o,c,h,l,p,f,d,v;return{setters:[function(t){e=t.createClass},function(t){r=t.cclegacy,n=t.director},function(t){s=t.mapItemRow,i=t.mapItemCol,u=t.typeCount,a=t.listCardCount,o=t.typeUniversal,c=t.typeScore,h=t.mapTotalCount,l=t.stepMap,p=t.levelMap},function(t){f=t.default},function(t){d=t.EResult,v=t.EventType}],execute:function(){r._RF.push({},"d1bccIZC2BPMZZAQS6cjB5X","DataManager",void 0);t("dataManager",new(function(){function t(){this.step=0,this.curListCount=0,this.dataArr=[],this.curLevelCfg=null,this._level=0,this.collectArr=[],this._score=0,this._countdown=0,this._isPause=!1}var r=t.prototype;return r.pause=function(){this.isPause=!0},r.resume=function(){this.isPause=!1},r.startGame=function(t){this.resume();var e=this.level||1;this.level=t?e+1:e,this.step=0,this.score=0,this.dataArr.length=0;for(var r=0;r<s;r++)for(var n=0;n<i;n++)this.dataArr.push({type:-1,num:0,x:n,y:r,idx:n+r*i});for(var a=0;a<u;a++)this.collectArr[a]=0;this.countdown=60*this.curLevelCfg.time},r.judgeGameResult=function(){var t=this,e=d.NORMAL,r=this.countdown>0&&this.collectArr.every((function(e,r){return e>=t.curLevelCfg.collectCount[r]})),n=this.score>=this.curLevelCfg.score,s=this.dataArr.every((function(t){return t.num>0}));return r&&n?e=d.WIN_2:s&&(e=r||n?d.WIN_1:d.FAIL),e},r.reduceTime=function(){this.countdown--},r.addStep=function(){this.step++;for(var t=1===this.step?a:1,e=[],r=this.curLevelCfg,n=0;n<t;n++){var s={type:f.getRandomByPercente(r.typeRate),num:f.getRandomByPercente(r.numRate)+1};e.push(s)}return console.log("步数:",this.step,e),e},r.reduceListCount=function(t){n.emit(v.createCard);var e=t.idx%i==0||t.idx>=(s-1)*i,r=this.dataArr[t.idx];return r.type=t.type,r.num=t.num+(!f.isUniversalCard(t.type)&&e?1:0),r.num},r.placeItem=function(t){var e=this,r=[],s=[t];if(this.ergodicData(t,s),s.length<=1){var i=this.dataArr[t];return i.type===o&&(i.num=0,i.type=-1,r.push(i)),r}var u=0;return s.forEach((function(t){var n=e.dataArr[t];n.num--,u+=c[n.type],e.collectArr[n.type]++,(n.num<=0||n.type===o)&&(n.num=0,n.type=-1),r.push(e.dataArr[t])})),this.score+=u,n.emit(v.placeCompleted),r},r.ergodicData=function(t,e){var r=this,n=this.getFourSidesIdx(t,e);0!==n.length&&(console.log("消除下标",n),n.forEach((function(t){return r.ergodicData(t,e)})))},r.getFourSidesIdx=function(t,e){var r=[],n=t+i;n<h&&this.sameCard(t,n)&&f.pushToArr(e,n)&&r.push(n);var s=t-i;s>=0&&this.sameCard(t,s)&&f.pushToArr(e,s)&&r.push(s);var u=t-1;u>=0&&t%i>0&&this.sameCard(t,u)&&f.pushToArr(e,u)&&r.push(u);var a=t+1;return a<h&&t%i!=i-1&&this.sameCard(t,a)&&f.pushToArr(e,a)&&r.push(a),r},r.sameCard=function(t,e){var r=this.dataArr[t],n=this.dataArr[e],s=r.num===n.num,i=r.type===n.type||r.type===o||n.type===o;return s&&i},r.getStepCfg=function(t){for(var e=0;e<l.length;e++){var r=l[e];if(t<=r.step)return r}return l[l.length-1]},r.getLevelCfg=function(){for(var t=0;t<p.length;t++){var e=p[t];if(this.level<=e.level)return e}return p[p.length-1]},e(t,[{key:"level",get:function(){return this._level},set:function(t){this._level=t,this.curLevelCfg=this.getLevelCfg()}},{key:"score",get:function(){return this._score},set:function(t){this._score=t,n.emit(v.updateScore)}},{key:"countdown",get:function(){return this._countdown},set:function(t){this._countdown=t}},{key:"isPause",get:function(){return this._isPause},set:function(t){this._isPause=t}}]),t}()));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalManager.ts","./DataManager.ts","./AppConst.ts","./MoveItem.ts","./AppEnum.ts"],(function(e){"use strict";var t,n,i,o,r,a,u,l,s,c,d,h,f,p,b,m,N,g,v,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,u=e.Node,l=e.Prefab,s=e.Label,c=e.director,d=e.instantiate,h=e.tween,f=e.v3,p=e.Component},function(e){b=e.globalManager},function(e){m=e.dataManager},function(e){N=e.listCardCount},function(e){g=e.MoveItem},function(e){v=e.EventType,C=e.EResult}],execute:function(){var y,w,L,E,P,T,_,z,G,I,M,A,O,S,x,R,U,D,k,F,H,V,j;r._RF.push({},"20370AdirlNx7B0OQ0xidWo","GameView",void 0);var B=a.ccclass,W=a.property;e("GameView",(y=B("GameView"),w=W(u),L=W(u),E=W(l),P=W(s),T=W(s),_=W(u),z=W(s),G=W(u),I=W(u),M=W(u),y((S=t((O=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"mapNode",S,o(t)),i(t,"listNode",x,o(t)),i(t,"cardPrefab",R,o(t)),i(t,"scoreLabel",U,o(t)),i(t,"timeLabel",D,o(t)),i(t,"endNode",k,o(t)),i(t,"endLabel",F,o(t)),i(t,"nextNode",H,o(t)),i(t,"pauseNode",V,o(t)),i(t,"resumeNode",j,o(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){b.init(this.node,this.mapNode),this.onInit()},r.onInit=function(){this.onEvent(),this.startGame(!1)},r.onEvent=function(){c.on(v.createCard,this.onCreateCard,this),c.on(v.updateScore,this.onUpdateScore,this),this.node.on(u.EventType.TOUCH_START,this._touchStart,this),this.node.on(u.EventType.TOUCH_MOVE,this._touchMove,this),this.node.on(u.EventType.TOUCH_END,this._touchEnd,this),this.node.on(u.EventType.TOUCH_CANCEL,this._touchCancel,this)},r.onCreateCard=function(){var e=this,t=m.addStep();if(t.length===N)for(var n=0,i=0;i<N;i++){var o=this.listNode.children[i];if(!(o.children.length>0)){var r=d(this.cardPrefab);o.addChild(r),r.getComponent(g).setData(t[n]),n++}}else{for(var a=function(t){var n=e.listNode.children[t];if(0===n.children.length)return"continue";var i=n.children[0];h(i).by(.2,{position:f(-153,0,0)}).call((function(){i.setParent(e.listNode.children[t-1]),i.setPosition(0,0,0)})).start()},u=this.listNode.children.findIndex((function(e){return 0===e.children.length}))+1;u<N;u++)a(u);this.scheduleOnce((function(){var n=d(e.cardPrefab);e.listNode.children[e.listNode.children.length-1].addChild(n),n.getComponent(g).setData(t[0]),e.scheduleOnce((function(){e.onPlaceCompleted()}),.1)}),.2)}},r.onUpdateScore=function(){this.scoreLabel.string=""+m.score},r.onPlaceCompleted=function(){var e=m.judgeGameResult();e!=C.NORMAL&&this.showEndNode(e)},r.showEndNode=function(e){this.unschedule(this.onTimer),this.listNode.children.forEach((function(e){e.children.length>0&&e.children[0].destroy()})),this.mapNode.children.forEach((function(e){e.children.length>0&&e.children[0].destroy()})),this.endNode.active=!0,this.nextNode.active=e!==C.FAIL,this.endLabel.string=e===C.FAIL?"FAIL!":"WIN!"},r.onTimer=function(){m.isPause||(m.reduceTime(),m.countdown<=0&&this.unschedule(this.onTimer),this.updateCountdown())},r.updateCountdown=function(){this.timeLabel.string=""+m.countdown},r.startGame=function(e){this.endNode.active=!1,m.startGame(e),this.schedule(this.onTimer,1),this.onCreateCard(),this.onUpdateScore(),this.updateCountdown(),this.setPause(!1)},r.setPause=function(e){this.pauseNode.active=!e,this.resumeNode.active=e},r.onClickPause=function(){m.pause(),this.setPause(!0)},r.onClickResume=function(){m.resume(),this.setPause(!1)},r.onClickNext=function(){this.startGame(!0)},r.onClickRestart=function(){this.startGame(!1)},r._touchStart=function(e){e.touch.getUILocation()},r._touchMove=function(e){},r._touchEnd=function(e){},r._touchCancel=function(e){},t}(p)).prototype,"mapNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(O.prototype,"listNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(O.prototype,"cardPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(O.prototype,"scoreLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(O.prototype,"timeLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(O.prototype,"endNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(O.prototype,"endLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(O.prototype,"nextNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"pauseNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(O.prototype,"resumeNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=O))||A));r._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalManager.ts",["cc"],(function(t){"use strict";var o;return{setters:[function(t){o=t.cclegacy}],execute:function(){o._RF.push({},"8bf149iqkJBcIiuifcR5jdI","GlobalManager",void 0);t("globalManager",new(function(){function t(){this.rootNode=null,this.mapNode=null}var o=t.prototype;return o.init=function(t,o){this.rootNode=t,this.mapNode=o},o.getMapItem=function(t){return this.mapNode.children[t]},o.getMapPos=function(){return this.mapNode.position},o.getRootNode=function(){return this.rootNode},o.setParent=function(t){t.setParent(this.rootNode)},t}()));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameView.ts","./MoveItem.ts","./AppConst.ts","./AppEnum.ts","./AppType.ts","./DataManager.ts","./GlobalManager.ts","./Utils.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MoveItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalManager.ts","./Utils.ts","./DataManager.ts","./AppConst.ts"],(function(t){"use strict";var e,n,i,o,s,a,r,u,h,c,l,d,p,f,_,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,r=t.Label,u=t.SpriteFrame,h=t.Sprite,c=t.Node,l=t.Component},function(t){d=t.globalManager},function(t){p=t.default},function(t){f=t.dataManager},function(t){_=t.typeUniversal,v=t.maxNumber}],execute:function(){var m,y,P,E,T,g,C,b,M;s._RF.push({},"1b2b7QWMyZEhoamNTz2AhtP","MoveItem",void 0);var N=a.ccclass,U=a.property;t("MoveItem",(m=N("MoveItem"),y=U(r),P=U([u]),E=U(h),m((C=e((g=function(t){function e(){for(var e,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,i(e,"lb_num",C,o(e)),i(e,"sp_arr",b,o(e)),i(e,"sp_card",M,o(e)),e.oldParent=null,e.data=null,e}n(e,t);var s=e.prototype;return s.onLoad=function(){this.onEvent()},s.onEvent=function(){this.node.on(c.EventType.TOUCH_START,this._touchStart,this),this.node.on(c.EventType.TOUCH_MOVE,this._touchMove,this),this.node.on(c.EventType.TOUCH_END,this._touchEnd,this),this.node.on(c.EventType.TOUCH_CANCEL,this._touchCancel,this)},s.removeEvent=function(){this.node.off(c.EventType.TOUCH_START,this._touchStart,this),this.node.off(c.EventType.TOUCH_MOVE,this._touchMove,this),this.node.off(c.EventType.TOUCH_END,this._touchEnd,this),this.node.off(c.EventType.TOUCH_CANCEL,this._touchCancel,this)},s.setData=function(t){this.data=t,this.setNum()},s.reduceNum=function(t){this.data.num=t,t<=0||this.data.type===_?(this.node.removeFromParent(),this.node.destroy()):this.setNum()},s.setNum=function(){this.sp_card.spriteFrame=this.sp_arr[this.data.type*v+this.data.num-1]},s._touchStart=function(t){if(!f.isPause){this.oldParent=this.node.parent,d.setParent(this.node);var e=t.touch.getUILocation();this._setPosition(e.x,e.y)}},s._touchMove=function(t){if(!f.isPause){var e=t.touch.getUILocation();this._setPosition(e.x,e.y)}},s._touchEnd=function(t){if(!f.isPause){var e=t.touch.getUILocation(),n=d.getMapPos(),i=p.countPosToDataIndex(e.x-n.x,e.y-n.y);if(console.log("当前位置下标",i),this._setPosition(0,0),i<0)this.node.setParent(this.oldParent);else{var o=d.getMapItem(i),s=0===o.children.length;this.node.setParent(s?o:this.oldParent),s&&this.onSuc(i)}}},s._touchCancel=function(t){f.isPause||(this._setPosition(0,0),this.node.setParent(this.oldParent))},s._setPosition=function(t,e){this.node.setPosition(t,e)},s.onSuc=function(t){this.removeEvent(),this.data.idx=t;var n=f.reduceListCount(this.data);this.data.num!==n&&(this.data.num=n,this.setNum()),f.placeItem(t).forEach((function(t){var n=d.getMapItem(t.idx);n&&n.children.length>0&&n.children[0].getComponent(e).reduceNum(t.num)})),this.node.setScale(.6,.6,1)},e}(l)).prototype,"lb_num",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(g.prototype,"sp_arr",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=e(g.prototype,"sp_card",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=g))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/Utils.ts",["cc","./AppConst.ts"],(function(t){"use strict";var n,e,r,o,i,u,a;return{setters:[function(t){n=t.cclegacy},function(t){e=t.mapMaxWidth,r=t.mapMaxHeight,o=t.mapItemCol,i=t.typeUniversal,u=t.mapItemAddSpaceWidth,a=t.mapItemAddSpaceHeight}],execute:function(){n._RF.push({},"0a389G/WdpGUoD6oUv/crli","Utils",void 0);t("default",function(){function t(){}return t.countPosToDataIndex=function(t,n){if(t>e||n>r)return-1;var i=this.countPosToDirectIndex(t,n);return i.idx_x+i.idx_y*o},t.countPosToDirectIndex=function(t,n){return{idx_x:Math.floor(t/u),idx_y:Math.floor(n/a)}},t.getRandom=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},t.getRandomByPercente=function(t){for(var n=this.getRandom(1,100),e=0,r=0;r<t.length;r++)if(n<=(e+=t[r]))return r;return 0},t.pushToArr=function(t,n){return t.indexOf(n)<0&&(t.push(n),!0)},t.isUniversalCard=function(t){return t===i},t}());n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});